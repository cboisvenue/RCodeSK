{
    "collab_server" : "",
    "contents" : "# Create a table for time series 1987:2012 of age, log(age), log(delta biomass), strata and Raster cellID\n\n# This script:\n\n# 1) Separates and creates yearly raster stacks in order to group the raster variables by:\n\n#           1) age(1984), 2) log(age(1984)), 3) log(smooth_delta_biomass_1984-1985), 4) strata\n\n# where each raster cell 5) (RasterID) constitutes a record in each given year\n\n# 2) Individual raster stacks are coverted to data.frames then into data.tables which are VERY memory\n# efficient and fast to process\n\n# 3) For each data.table, the variable RasterID is created which is assigned the raster cell ID and \n# is set as a data.table key for efficient indexing. NA records within a given year removed\n# if any still exists after NA syncing and the strata column is renamed to be associated to a \n# given year (may not need this anymore)\n\n# 4) After individual year data.tables are created they are combined using 'rbindlist' into a single\n# data.table and written to file. NOTE that within each step temp files are removed (\"rm\") in order to \n# avoid unnecessary files being preserved in memory\n\n#Author: Byron Smiley & Kangakola Omendja\n#Date: June 14 2015\n#Modified: July 30 2015\n\n# With data.table package and removing unneeded/temp data (lists, stacks, tables) as you go this \n#script didn't use any more than 35% of A105350's memory (~23GB), ranging between 20% and 33% of \n# memory capacity\n\n#Required Inputs:\n\n# NOTE: ALL INPUTS HAVE HAD THEIR NA VALUES SYNCED ACROSS ALL YEARS IN ORDER TO REMOVE THOSE\n# NAS ACROSS ALL YEARS. THIS REDUCES THE NUMBER OF RECORDS IN EACH YEAR THAT WOULD NEED TO BE\n# PROCESSED BY THIS SCRIPT BUT WHICH ARE REDUNDANT FOR THE FINAL OUTPUT. THE SYNCING OF NAS\n# OCCURS IN \"RS_growth_rate_rasters_smooth.R\" WHERE ALL INPUTS FOR THIS SCRIPT ARE DERIVED.\n\n# 1) age rasters (1984-2012)\n# 2) logged age rasters (1984-2012)\n# 3) logged smoothed delta biomass rasters (1985-2012)\n# 4) strata raster\n\n#Packages--------------------------------------------------------------------------------------------\nlibrary(data.table)\nlibrary(raster)\nlibrary(parallel)\nlibrary(snow)\nlibrary(dplyr)\nrasterOptions(tmpdir=\"H:/saskatchewan/data/temp\")\n#Clear workspace --------------------------------------------------\nrm(list=ls())\n\n#-------------------------------------------------\n#Identify input and output directories and constant variables\nindir <- \"H:/saskatchewan/spatialGrowth/fmapa/RSGrowthSmoothSyncNA\"\nyears <- 1985:2012\noutdir <- \"H:/saskatchewan/spatialGrowth/fmapa/RSGrowthSmoothSyncNA/tables\"\n\n# List and Stack-----------------------------------------------------------------------\n#make list of all rasters to be included in dataframe\nallfiles <- list.files(paste(indir), full.names=TRUE, pattern=\"*tif\") # make list of file names\n\n#Set directory to where rasters are\nsetwd(indir)\n\n#list files for only 1 year of data... need all 28 (1985-2012) so we can create stacks then\n#extract dataframes from those stacks\n startTime <- Sys.time()\n# each stack (or record) must be the strata layer (same one for each stack), age rasters \n#(age and log(age)) from one year and the delta biomass from the following year\nyear_file1 <-grep(\"*/1984|*_1985|strata\", allfiles, value=TRUE)\nyear_file2 <-grep(\"*/1985|*_1986|strata\", allfiles, value=TRUE)\nyear_file3 <-grep(\"*/1986|*_1987|strata\", allfiles, value=TRUE)\nyear_file4 <-grep(\"*/1987|*_1988|strata\", allfiles, value=TRUE)\nyear_file5 <- grep(\"*/1988|*_1989|strata\", allfiles, value=TRUE)\nyear_file6 <- grep(\"*/1989|*_1990|strata\", allfiles, value=TRUE)\nyear_file7 <- grep(\"*/1990|*_1991|strata\", allfiles, value=TRUE)\nyear_file8 <- grep(\"*/1991|*_1992|strata\", allfiles, value=TRUE)\nyear_file9 <- grep(\"*/1992|*_1993|strata\", allfiles, value=TRUE)\nyear_file10 <- grep(\"*/1993|*_1994|strata\", allfiles, value=TRUE)\nyear_file11 <- grep(\"*/1994|*_1995|strata\", allfiles, value=TRUE)\nyear_file12 <- grep(\"*/1995|*_1996|strata\", allfiles, value=TRUE)\nyear_file13 <- grep(\"*/1996|*_1997|strata\", allfiles, value=TRUE)\nyear_file14 <- grep(\"*/1997|*_1998|strata\", allfiles, value=TRUE)\nyear_file15 <- grep(\"*/1998|*_1999|strata\", allfiles, value=TRUE)\nyear_file16 <- grep(\"*/1999|*_2000|strata\", allfiles, value=TRUE)\nyear_file17 <- grep(\"*/2000|*_2001|strata\", allfiles, value=TRUE)\nyear_file18 <- grep(\"*/2001|*_2002|strata\", allfiles, value=TRUE)\nyear_file19 <- grep(\"*/2002|*_2003|strata\", allfiles, value=TRUE)\nyear_file20 <- grep(\"*/2003|*_2004|strata\", allfiles, value=TRUE)\nyear_file21 <- grep(\"*/2004|*_2005|strata\", allfiles, value=TRUE)\nyear_file22 <- grep(\"*/2005|*_2006|strata\", allfiles, value=TRUE)\nyear_file23 <- grep(\"*/2006|*_2007|strata\", allfiles, value=TRUE)\nyear_file24 <- grep(\"*/2007|*_2008|strata\", allfiles, value=TRUE)\nyear_file25 <- grep(\"*/2008|*_2009|strata\", allfiles, value=TRUE)\nyear_file26 <- grep(\"*/2009|*_2010|strata\", allfiles, value=TRUE)\nyear_file27 <- grep(\"*/2010|*_2011|strata\", allfiles, value=TRUE)\nyear_file28 <- grep(\"*/2011|*_2012|strata\", allfiles, value=TRUE)\n\n # Make individual stacks each year group\n stack1 <- stack(year_file1)\n stack2 <- stack(year_file2)\n stack3 <- stack(year_file3)\n stack4 <- stack(year_file4)\n stack5 <- stack(year_file5)\n stack6 <- stack(year_file6)\n stack7 <- stack(year_file7)\n stack8 <- stack(year_file8)\n stack9 <- stack(year_file9)\n stack10 <- stack(year_file10)\n stack11 <- stack(year_file11)\n stack12 <- stack(year_file12)\n stack13 <- stack(year_file13)\n stack14 <- stack(year_file14)\n stack15 <- stack(year_file15)\n stack16 <- stack(year_file16)\n stack17 <- stack(year_file17)\n stack18 <- stack(year_file18)\n stack19 <- stack(year_file19)\n stack20 <- stack(year_file20)\n stack21 <- stack(year_file21)\n stack22 <- stack(year_file22)\n stack23 <- stack(year_file23)\n stack24 <- stack(year_file24)\n stack25 <- stack(year_file25)\n stack26 <- stack(year_file26)\n stack27 <- stack(year_file27)\n stack28 <- stack(year_file28)\n junk_startTime <- Sys.time()\n# End of list and stack-----------------------------------------------------------------------\n \n # clean some  unused r object in the workspace\n \n rm(\"year_file1\",\"year_file2\",\"year_file3\",\"year_file4\",\"year_file5\",\"year_file6\",\"year_file7\",\n    \"year_file8\",\"year_file9\",\"year_file10\",\"year_file11\",\"year_file12\",\"year_file13\",\"year_file14\",\n    \"year_file15\",\"year_file16\",\"year_file17\",\"year_file18\",\"year_file19\",\"year_file20\",\n    \"year_file21\",\"year_file22\",\"year_file23\",\"year_file24\",\"year_file25\",\"year_file26\",\n    \"year_file27\",\"year_file28\")\n#------------------------------------------------------------------------------------------------\n #Convert yearly stacked data (1985-2012) to data.frames then data.tables for efficient \n #memory processing and remove NAs and add rasterID column\n \n startTime <- Sys.time()\n#----1985----------------\n RS_df1985 <- as.data.frame(stack1) # read the stack as data frame\n DT_df1985 <- data.table(RS_df1985)\n DT_df1985[, RasterID1 := as.numeric(rownames(DT_df1985))]\n #DT_df1985_a <- DT_df1985[,!\"RasterID\", with=FALSE] # remove column from data.table\n setkey(DT_df1985,RasterID1) # set a key for indexing\n DT_df1985_b <- DT_df1985[is.finite(rowSums(DT_df1985))] # remove NAs from the data table\n setnames(DT_df1985_b,\"strata\",\"strata85\")\n rm(RS_df1985,DT_df1985)\n \n  #---1986-----------------------\n RS_df1986 <- as.data.frame(stack2) # read the stack as data frame\n DT_df1986 <- data.table(RS_df1986)\n DT_df1986[, RasterID1 := as.numeric(rownames(DT_df1986))]\n #DT_df1986_a <- DT_df1986[,!\"RasterID\", with=FALSE] # remove column from data.table\n setkey(DT_df1986,RasterID1) # set a key for indexing\n DT_df1986_b <- DT_df1986[is.finite(rowSums(DT_df1986))] # remove NAs from the data table\n setnames(DT_df1986_b,\"strata\",\"strata86\")\n rm(RS_df1986,DT_df1986)\n#######################################################\n\n #---1987-----------------------\n RS_df1987 <- as.data.frame(stack3) # read the stack as data frame\n DT_df1987 <- data.table(RS_df1987)\n DT_df1987[, RasterID1 := as.numeric(rownames(DT_df1987))]\n #DT_df1987_a <- DT_df1987[,!\"RasterID\", with=FALSE] # remove column from data.table\n setkey(DT_df1987,RasterID1) # set a key for indexing\n DT_df1987_b <- DT_df1987[is.finite(rowSums(DT_df1987))] # remove NAs from the data table\nsetnames(DT_df1987_b,\"strata\",\"strata87\")\n rm(RS_df1987,DT_df1987)\n \n  #---1988-----------------------\n RS_df1988 <- as.data.frame(stack4)\n DT_df1988 <- data.table(RS_df1988)\n DT_df1988[, RasterID1 := as.numeric(rownames(DT_df1988))]\n setkey(DT_df1988,RasterID1) # set a key for indexing\n DT_df1988_b <- DT_df1988[is.finite(rowSums(DT_df1988))] # remove NAs from the data table\n setnames(DT_df1988_b,\"strata\",\"strata88\")\n rm(RS_df1988,DT_df1988)\n#######################################################\n\n #---1989-----------------------\n RS_df1989 <- as.data.frame(stack5)\n DT_df1989 <- data.table(RS_df1989)\n DT_df1989[, RasterID1 := as.numeric(rownames(DT_df1989))]\n #DT_df1989_a <- DT_df1989[,!\"RasterID\", with=FALSE] # remove column from data.table\n setkey(DT_df1989,RasterID1) # set a key for indexing\n DT_df1989_b <- DT_df1989[is.finite(rowSums(DT_df1989))] # remove NAs from the data table\n setnames(DT_df1989_b,\"strata\",\"strata89\")\n rm(RS_df1989,DT_df1989)\n #---1990-----------------------\n RS_df1990 <- as.data.frame(stack6)\n DT_df1990 <- data.table(RS_df1990)\n DT_df1990[, RasterID1 := as.numeric(rownames(DT_df1990))]\n #DT_df1990_a <- DT_df1990[,!\"RasterID\", with=FALSE] # remove column from data.table\n setkey(DT_df1990,RasterID1) # set a key for indexing\n DT_df1990_b <- DT_df1990[is.finite(rowSums(DT_df1990))] # remove NAs from the data table\n setnames(DT_df1990_b,\"strata\",\"strata90\")\n rm(RS_df1990,DT_df1990)\n#######################################################\n\n #---1991-----------------------\n RS_df1991 <- as.data.frame(stack7)\n DT_df1991 <- data.table(RS_df1991)\n DT_df1991[, RasterID1 := as.numeric(rownames(DT_df1991))]\n #DT_df1991_a <- DT_df1991[,!\"RasterID\", with=FALSE] # remove column from data.table\n setkey(DT_df1991,RasterID1) # set a key for indexing\n DT_df1991_b <- DT_df1991[is.finite(rowSums(DT_df1991))] # remove NAs from the data table\n setnames(DT_df1991_b,\"strata\",\"strata91\")\n rm(RS_df1991,DT_df1991)\n #---1992-----------------------\n RS_df1992 <- as.data.frame(stack8)\n DT_df1992 <- data.table(RS_df1992)\n DT_df1992[, RasterID1 := as.numeric(rownames(DT_df1992))]\n #DT_df1992_a <- DT_df1992[,!\"RasterID\", with=FALSE] # remove column from data.table\n setkey(DT_df1992,RasterID1) # set a key for indexing\n DT_df1992_b <- DT_df1992[is.finite(rowSums(DT_df1992))] # remove NAs from the data table\n setnames(DT_df1992_b,\"strata\",\"strata92\")\n rm(RS_df1992,DT_df1992)\n#######################################################\n\n#---1993-----------------------\n RS_df1993 <- as.data.frame(stack9)\n DT_df1993 <- data.table(RS_df1993)\n DT_df1993[, RasterID1 := as.numeric(rownames(DT_df1993))]\n #DT_df1993_a <- DT_df1993[,!\"RasterID\", with=FALSE] # remove column from data.table\n setkey(DT_df1993,RasterID1) # set a key for indexing\n DT_df1993_b <- DT_df1993[is.finite(rowSums(DT_df1993))] # remove NAs from the data table\nsetnames(DT_df1993_b,\"strata\",\"strata93\")\n rm(RS_df1993,DT_df1993)\n#---1994-----------------------\n RS_df1994 <- as.data.frame(stack10)\n DT_df1994 <- data.table(RS_df1994)\n DT_df1994[, RasterID1 := as.numeric(rownames(DT_df1994))]\n #DT_df1994_a <- DT_df1994[,!\"RasterID\", with=FALSE] # remove column from data.table\n setkey(DT_df1994,RasterID1) # set a key for indexing\n DT_df1994_b <- DT_df1994[is.finite(rowSums(DT_df1994))] # remove NAs from the data table\n setnames(DT_df1994_b,\"strata\",\"strata94\")\n rm(RS_df1994,DT_df1994)\n#######################################################\n\n #---1995-----------------------\n RS_df1995 <- as.data.frame(stack11)\n DT_df1995 <- data.table(RS_df1995)\n DT_df1995[, RasterID1 := as.numeric(rownames(DT_df1995))]\n #DT_df1995_a <- DT_df1995[,!\"RasterID\", with=FALSE] # remove column from data.table\n setkey(DT_df1995,RasterID1) # set a key for indexing\n DT_df1995_b <- DT_df1995[is.finite(rowSums(DT_df1995))] # remove NAs from the data table\n setnames(DT_df1995_b,\"strata\",\"strata95\")\n rm(RS_df1995,DT_df1995)\n\n #---1996-----------------------\n RS_df1996 <- as.data.frame(stack12)\n DT_df1996 <- data.table(RS_df1996)\n DT_df1996[, RasterID1 := as.numeric(rownames(DT_df1996))]\n #DT_df1996_a <- DT_df1996[,!\"RasterID\", with=FALSE] # remove column from data.table\n setkey(DT_df1996,RasterID1) # set a key for indexing\n DT_df1996_b <- DT_df1996[is.finite(rowSums(DT_df1996))] # remove NAs from the data table\n setnames(DT_df1996_b,\"strata\",\"strata96\")\n rm(RS_df1996,DT_df1996)\n#######################################################\n\n #---1997-----------------------\n RS_df1997 <- as.data.frame(stack13)\n DT_df1997 <- data.table(RS_df1997)\n DT_df1997[, RasterID1 := as.numeric(rownames(DT_df1997))]\n #DT_df1997_a <- DT_df1997[,!\"RasterID\", with=FALSE] # remove column from data.table\n setkey(DT_df1997,RasterID1) # set a key for indexing\n DT_df1997_b <- DT_df1997[is.finite(rowSums(DT_df1997))] # remove NAs from the data table\n setnames(DT_df1997_b,\"strata\",\"strata97\")\n rm(RS_df1997,DT_df1997)\n #---1998-----------------------\n RS_df1998 <- as.data.frame(stack14)\n DT_df1998 <- data.table(RS_df1998)\n DT_df1998[, RasterID1 := as.numeric(rownames(DT_df1998))]\n #DT_df1998_a <- DT_df1998[,!\"RasterID\", with=FALSE] # remove column from data.table\n setkey(DT_df1998,RasterID1) # set a key for indexing\n DT_df1998_b <- DT_df1998[is.finite(rowSums(DT_df1998))] # remove NAs from the data table\n setnames(DT_df1998_b,\"strata\",\"strata98\")\n rm(RS_df1998,DT_df1998)\n#######################################################\n\n#---1999-----------------------\n RS_df1999 <- as.data.frame(stack15)\n DT_df1999 <- data.table(RS_df1999)\n DT_df1999[, RasterID1 := as.numeric(rownames(DT_df1999))]\n #DT_df1999_a <- DT_df1999[,!\"RasterID\", with=FALSE] # remove column from data.table\n setkey(DT_df1999,RasterID1) # set a key for indexing\n DT_df1999_b <- DT_df1999[is.finite(rowSums(DT_df1999))] # remove NAs from the data table\n setnames(DT_df1999_b,\"strata\",\"strata99\")\n rm(RS_df1999,DT_df1999)\n #---2000-----------------------\n RS_df2000 <- as.data.frame(stack16)\n DT_df2000 <- data.table(RS_df2000)\n DT_df2000[, RasterID1 := as.numeric(rownames(DT_df2000))]\n #DT_df2000_a <- DT_df2000[,!\"RasterID\", with=FALSE] # remove column from data.table\n setkey(DT_df2000,RasterID1) # set a key for indexing\n DT_df2000_b <- DT_df2000[is.finite(rowSums(DT_df2000))] # remove NAs from the data table\n setnames(DT_df2000_b,\"strata\",\"strata00\")\n rm(RS_df2000,DT_df2000)\n#######################################################\n\n #---2001-----------------------\n RS_df2001 <- as.data.frame(stack17)\n DT_df2001 <- data.table(RS_df2001)\n DT_df2001[, RasterID1 := as.numeric(rownames(DT_df2001))]\n #DT_df2001_a <- DT_df2001[,!\"RasterID\", with=FALSE] # remove column from data.table\n setkey(DT_df2001,RasterID1) # set a key for indexing\n DT_df2001_b <- DT_df2001[is.finite(rowSums(DT_df2001))] # remove NAs from the data table\n setnames(DT_df2001_b,\"strata\",\"strata01\")\n rm(RS_df2001,DT_df2001)\n#---2002-----------------------\n RS_df2002 <- as.data.frame(stack18)\n DT_df2002 <- data.table(RS_df2002)\n DT_df2002[, RasterID1 := as.numeric(rownames(DT_df2002))]\n #DT_df2002_a <- DT_df2002[,!\"RasterID\", with=FALSE] # remove column from data.table\n setkey(DT_df2002,RasterID1) # set a key for indexing\n DT_df2002_b <- DT_df2002[is.finite(rowSums(DT_df2002))] # remove NAs from the data table\n setnames(DT_df2002_b,\"strata\",\"strata02\")\n rm(RS_df2002,DT_df2002)\n#######################################################\n\n #---2003-----------------------\n RS_df2003 <- as.data.frame(stack19)\n DT_df2003 <- data.table(RS_df2003)\n DT_df2003[, RasterID1 := as.numeric(rownames(DT_df2003))]\n #DT_df2003_a <- DT_df2003[,!\"RasterID\", with=FALSE] # remove column from data.table\n setkey(DT_df2003,RasterID1) # set a key for indexing\n DT_df2003_b <- DT_df2003[is.finite(rowSums(DT_df2003))] # remove NAs from the data table\n setnames(DT_df2003_b,\"strata\",\"strata03\")\n rm(RS_df2003,DT_df2003)\n #---2004-----------------------\n RS_df2004 <- as.data.frame(stack20)\n DT_df2004 <- data.table(RS_df2004)\n DT_df2004[, RasterID1 := as.numeric(rownames(DT_df2004))]\n #DT_df2004_a <- DT_df2004[,!\"RasterID\", with=FALSE] # remove column from data.table\n setkey(DT_df2004,RasterID1) # set a key for indexing\n DT_df2004_b <- DT_df2004[is.finite(rowSums(DT_df2004))] # remove NAs from the data table\n setnames(DT_df2004_b,\"strata\",\"strata04\")\n rm(RS_df2004,DT_df2004)\n###########################\n\n #---2005-----------------------\n RS_df2005 <- as.data.frame(stack21)\n DT_df2005 <- data.table(RS_df2005)\n DT_df2005[, RasterID1 := as.numeric(rownames(DT_df2005))]\n #DT_df2005_a <- DT_df2005[,!\"RasterID\", with=FALSE] # remove column from data.table\n setkey(DT_df2005,RasterID1) # set a key for indexing\n DT_df2005_b <- DT_df2005[is.finite(rowSums(DT_df2005))] # remove NAs from the data table\n setnames(DT_df2005_b,\"strata\",\"strata05\")\n rm(RS_df2005,DT_df2005)\n #---2006-----------------------\n RS_df2006 <- as.data.frame(stack22)\n DT_df2006 <- data.table(RS_df2006)\n DT_df2006[, RasterID1 := as.numeric(rownames(DT_df2006))]\n #DT_df2006_a <- DT_df2006[,!\"RasterID\", with=FALSE] # remove column from data.table\n setkey(DT_df2006,RasterID1) # set a key for indexing\n DT_df2006_b <- DT_df2006[is.finite(rowSums(DT_df2006))] # remove NAs from the data table\n setnames(DT_df2006_b,\"strata\",\"strata06\")\n rm(RS_df2006,DT_df2006)\n################################\n\n #---2007-----------------------\n RS_df2007 <- as.data.frame(stack23)\n DT_df2007 <- data.table(RS_df2007)\n DT_df2007[, RasterID1 := as.numeric(rownames(DT_df2007))]\n #DT_df2007_a <- DT_df2007[,!\"RasterID\", with=FALSE] # remove column from data.table\n setkey(DT_df2007,RasterID1) # set a key for indexing\n DT_df2007_b <- DT_df2007[is.finite(rowSums(DT_df2007))] # remove NAs from the data table\n setnames(DT_df2007_b,\"strata\",\"strata07\")\n rm(RS_df2007,DT_df2007)\n #---2008-----------------------\n RS_df2008 <- as.data.frame(stack24)\n DT_df2008 <- data.table(RS_df2008)\n DT_df2008[, RasterID1 := as.numeric(rownames(DT_df2008))]\n #DT_df2008_a <- DT_df2008[,!\"RasterID\", with=FALSE] # remove column from data.table\n setkey(DT_df2008,RasterID1) # set a key for indexing\n DT_df2008_b <- DT_df2008[is.finite(rowSums(DT_df2008))] # remove NAs from the data table\n setnames(DT_df2008_b,\"strata\",\"strata08\")\n rm(RS_df2008,DT_df2008)\n####################################\n\n#---2009-----------------------\n RS_df2009 <- as.data.frame(stack25)\n DT_df2009 <- data.table(RS_df2009)\n DT_df2009[, RasterID1 := as.numeric(rownames(DT_df2009))]\n #DT_df2009_a <- DT_df2009[,!\"RasterID\", with=FALSE] # remove column from data.table\n setkey(DT_df2009,RasterID1) # set a key for indexing\n DT_df2009_b <- DT_df2009[is.finite(rowSums(DT_df2009))] # remove NAs from the data table\n setnames(DT_df2009_b,\"strata\",\"strata09\")\n rm(RS_df2009,DT_df2009)\n #---2010-----------------------\n RS_df2010 <- as.data.frame(stack26)\n DT_df2010 <- data.table(RS_df2010)\n DT_df2010[, RasterID1 := as.numeric(rownames(DT_df2010))]\n #DT_df2010_a <- DT_df2010[,!\"RasterID\", with=FALSE] # remove column from data.table\n setkey(DT_df2010,RasterID1) # set a key for indexing\n DT_df2010_b <- DT_df2010[is.finite(rowSums(DT_df2010))] # remove NAs from the data table\n setnames(DT_df2010_b,\"strata\",\"strata10\")\n rm(RS_df2010,DT_df2010)\n####################################\n\n #---2011-----------------------\n RS_df2011 <- as.data.frame(stack27)\n DT_df2011 <- data.table(RS_df2011)\n DT_df2011[, RasterID1 := as.numeric(rownames(DT_df2011))]\n #DT_df2011_a <- DT_df2011[,!\"RasterID\", with=FALSE] # remove column from data.table\n setkey(DT_df2011,RasterID1) # set a key for indexing\n DT_df2011_b <- DT_df2011[is.finite(rowSums(DT_df2011))] # remove NAs from the data table\n setnames(DT_df2011_b,\"strata\",\"strata11\")\n rm(RS_df2011,DT_df2011)\n#---2012-----------------------\n RS_df2012 <- as.data.frame(stack28)\n DT_df2012 <- data.table(RS_df2012)\n DT_df2012[, RasterID1 := as.numeric(rownames(DT_df2012))]\n #DT_df2012_a <- DT_df2012[,!\"RasterID\", with=FALSE] # remove column from data.table\n setkey(DT_df2012,RasterID1) # set a key for indexing\n DT_df2012_b <- DT_df2012[is.finite(rowSums(DT_df2012))] # remove NAs from the data table\n setnames(DT_df2012_b,\"strata\",\"strata12\")\n rm(RS_df2012,DT_df2012)\n \n endTime <- Sys.time()\n elapsedTime_ALL <- endTime - startTime\n #2.27 hours for 1987-2012... probably 2.5hours for all years or so...\n \n # End of individual year data.table creation-----------------------------------------------------\n \n #############################################################################\n # Remove uneeded data\n \n rm(stack1,stack2,stack3,stack4,stack5,stack6,stack7,stack8,stack9,stack10,stack11,stack12,stack13,\n    stack14,stack15,stack16,stack17,stack18,stack19,stack20,stack21,stack22,stack23,stack24,stack25,\n    stack26,stack27,stack28)\n##############################################################################\n \n#MERGE data.tables and export--------------------------------------------------------------------\n \n # create a list of all data.table names\n \n allDT_list <- list(DT_df1985_b,DT_df1986_b,DT_df1987_b,DT_df1988_b,DT_df1989_b,DT_df1990_b,\n                   DT_df1991_b,DT_df1992_b,DT_df1993_b,DT_df1994_b,DT_df1995_b,DT_df1996_b,\n                   DT_df1997_b,DT_df1998_b,DT_df1999_b,DT_df2000_b,DT_df2001_b,DT_df2002_b,\n                   DT_df2003_b,DT_df2004_b,DT_df2005_b,DT_df2006_b,DT_df2007_b,DT_df2008_b,\n                   DT_df2009_b,DT_df2010_b,DT_df2011_b,DT_df2012_b)\n \n # Combine all individual year data tables into one\n DT_all <- rbindlist(allDT_list, use.names = FALSE, fill=FALSE)\n \n #Write combined data.table to file\n write.table(DT_all, paste(outdir,\"DT_all.txt\",sep=\"/\"), sep=\",\",row.names=FALSE)\n \n #End of raster to table export-------------------------------------------------------------------\n ",
    "created" : 1496963829751.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "2228265335",
    "id" : "4C32B313",
    "lastKnownWriteTime" : 1459373154,
    "last_content_update" : 1459373154,
    "path" : "C:/Celine/GitHub/RCodeSK/RS_growth_tables_creation.R",
    "project_path" : null,
    "properties" : {
    },
    "relative_order" : 1,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}